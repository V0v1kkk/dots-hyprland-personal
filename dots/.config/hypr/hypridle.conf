$lock_cmd = hyprctl dispatch global quickshell:lock & pidof qs quickshell hyprlock || hyprlock
# $lock_cmd = pidof hyprlock || hyprlock
$suspend_cmd = systemctl suspend || loginctl suspend

general {
    lock_cmd = $lock_cmd
    before_sleep_cmd = loginctl lock-session
    after_sleep_cmd = hyprctl dispatch global quickshell:lockFocus
    inhibit_sleep = 3
}

# OLED Screen Protection - Progressive dimming without auto-lock
# HDMI-A-2 (YMK EM160 TOUCH, ноутбук OLED) - DDC/CI работает через /dev/i2c-6
# HDMI-A-3 (LG TV) - DDC/CI detection fails via ddcutil CLI с NVIDIA драйвером
#                  - PowerDevil (KDE) управляет через libddcutil API успешно
#                  - В Hyprland без PowerDevil может заработать ddcutil CLI
#                  - Пока: только DPMS, тестировать после первого запуска Hyprland

# 10 min - dim OLED to 10% brightness
# listener {
#     timeout = 600
#     on-timeout = ddcutil setvcp 10 10 --bus 6
#     on-resume = ddcutil setvcp 10 35 --bus 6
# }

# TODO: После первого запуска Hyprland протестировать ddcutil для LG TV:
# sudo ddcutil getvcp 10 --bus 8
# Если успешно, добавить listener для LG TV перед DPMS:
# listener {
#     timeout = 600
#     on-timeout = ddcutil setvcp 10 20 --bus 8
#     on-resume = ddcutil setvcp 10 100 --bus 8
# }

# 10 min - Black screensaver via hyprlock-blank (полная защита OLED без DPMS)
# Grace period 315360000 сек (~10 лет) = фактически без пароля
# Черный экран #000000 = OLED пиксели полностью выключены
listener {
    timeout = 600
    on-timeout = pidof hyprlock || hyprlock --grace 315360000 -c ~/.config/hypr/hyprlock-blank.conf
    on-resume = killall hyprlock
}

# No auto-lock, no auto-suspend (home PC)
# Lock manually: Super+L (if configured) or logout menu
# Note: --async flag removed (deprecated since ddcutil 2.0+)
